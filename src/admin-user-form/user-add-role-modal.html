<div class="modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" aria-label="Close" ng-click="$hide()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">{{'adminUserForm.addRole'| message}}</h4>
                </div>
                <div class="modal-body">
                    <form id="addRoleForm" name="addRoleForm" class="user-form" ng-submit="vm.addRole()">
                        <label>
                            <span>{{'adminUserForm.username' | message}}</span>
                            <span>{{vm.user.username}}</span>
                        </label>
                        <fieldset>
                            <label for="type">{{'adminUserForm.type' | message}}</label>
                            <select id="type" ng-model="vm.newRoleAssignment.type"
                                    ng-options="type for type in vm.types"
                                    ng-change="vm.loadRoles()" required>
                            </select>
                            <label for="role">{{'adminUserForm.role' | message}}</label>
                            <select id="role" ng-model="vm.newRoleAssignment.role"
                                    ng-options="role.name for role in vm.filteredRoles" required>
                            </select>
                            <p ng-if="vm.newRoleAssignment.role">{{vm.newRoleAssignment.role.description}}</p>
                        </fieldset>
                        <fieldset ng-if="vm.isSupervisionType()">
                            <label for="requiredField">{{'adminUserForm.requiredSupervisionField' | message}}</label>
                            <select id="requiredField" ng-model="vm.requiredSupervisionField"
                                ng-init="vm.requiredSupervisionField = vm.supervisionFields[0].value" required
                                ng-options="requiredField.value as requiredField.message for requiredField in vm.supervisionFields">
                            </select>
                        </fieldset>
                        <fieldset ng-if="vm.isSupervisionType() && vm.requiredSupervisionField === 'program'">
                            <label for="program">{{'adminUserForm.program' | message}}</label>
                            <select id="program" ng-model="vm.newRoleAssignment.program"
                                    ng-options="program.code as program.name for program in vm.programs" required>
                            </select>
                            <label ng-if="vm.newRoleAssignment.program"
                                    for="supervisoryNode">{{'adminUserForm.supervisoryNode' | message}}</label>
                            <select ng-if="vm.newRoleAssignment.program"
                                    id="supervisoryNode" ng-model="vm.newRoleAssignment.supervisoryNode"
                                    ng-options="supervisoryNode.code as supervisoryNode.$display for supervisoryNode in vm.supervisoryNodes">
                            </select>
                        </fieldset>
                        <fieldset ng-if="vm.isSupervisionType() && vm.requiredSupervisionField === 'supervisoryNode'">
                            <label for="supervisoryNode">{{'adminUserForm.supervisoryNode' | message}}</label>
                            <select id="supervisoryNode" ng-model="vm.newRoleAssignment.supervisoryNode" required
                                    ng-options="supervisoryNode.code as supervisoryNode.$display for supervisoryNode in vm.supervisoryNodes">
                            </select>
                            <label ng-if="vm.newRoleAssignment.supervisoryNode"
                                    for="program">{{'adminUserForm.program' | message}}</label>
                            <select ng-if="vm.newRoleAssignment.supervisoryNode"
                                    id="program" ng-model="vm.newRoleAssignment.program"
                                    ng-options="program.code as program.name for program in vm.programs">
                            </select>
                        </fieldset>
                        <fieldset ng-if="vm.isFulfillmentType()">
                            <label for="warehouse">{{'adminUserForm.warehouse' | message}}</label>
                            <select id="warehouse" ng-model="vm.newRoleAssignment.warehouse"
                                    ng-options="warehouse.code as warehouse.name for warehouse in vm.warehouses" required>
                            </select>
                        </fieldset>
                    </form>
                </div>
                <div class="modal-footer">
                    <button ng-click="$hide()">{{'adminUserForm.cancel' | message}}</button>
                    <input form="addRoleForm" type="submit" value="{{'adminUserForm.addRole'| message}}"/>
                </div>
        </div>
    </div>
</div>
